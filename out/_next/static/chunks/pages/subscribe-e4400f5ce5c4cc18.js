(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{4263:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/subscribe",function(){return n(9681)}])},4225:function(e,t,n){"use strict";n.d(t,{Z:function(){return NavBack}});var i=n(5893),r=n(1163);function NavBack(){let e=(0,r.useRouter)();return(0,i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:(0,i.jsx)("button",{onClick:()=>e.back(),style:{background:"#e5e7eb",border:"none",padding:"8px 14px",borderRadius:6,cursor:"pointer",fontWeight:"bold"},children:"← Back"})})}n(1664)},9681:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Subscribe}});var i=n(5893),r=n(9008),o=n.n(r),s=n(7294),l=n(1163),a=n(1664),d=n.n(a),c=n(4225);function Subscribe(){let[e,t]=(0,s.useState)(null),[n,r]=(0,s.useState)(!1),[a,u]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[g,j]=(0,s.useState)(!1),m=(0,l.useRouter)();(0,s.useEffect)(()=>{u(!0),async function(){try{let e=await fetch("/api/me"),n=await e.json();n.ok&&(t(n.user),h("DR-".concat(n.user.id,"-").concat(Math.floor(1e3+9e3*Math.random()))))}catch(e){console.error("User fetch error")}}()},[]);let handlePopUpload=async e=>{let t=e.target.files[0];if(!t)return;j(!0);let n=new FormData;n.append("file",t);try{let e=await fetch("/api/upload",{method:"POST",body:n}),t=await e.json();t.url?y(t.url):alert("Upload failed. Please try again.")}catch(e){alert("Error uploading file.")}finally{j(!1)}},handleNotifyEFT=async()=>{if(!e){m.push("/login?redirect=/subscribe");return}if(!b){alert("Please upload your Proof of Payment before submitting.");return}r(!0);try{let t=await fetch("/api/subscribe/notify-eft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,reference:x,popUrl:b})});t.ok?f(!0):alert("Could not send notification. Please try again.")}catch(e){alert("Error sending notification.")}finally{r(!1)}};return a?(0,i.jsxs)("div",{style:{maxWidth:500,margin:"40px auto",padding:20,fontFamily:"Arial, sans-serif"},children:[(0,i.jsx)(c.Z,{}),(0,i.jsx)(o(),{children:(0,i.jsx)("title",{children:"Subscribe via EFT — DriverRate"})}),(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:30},children:[(0,i.jsx)("h1",{style:{fontSize:"28px",color:"#1e293b"},children:"Premium Subscription"}),(0,i.jsxs)("p",{style:{color:"#64748b"},children:["Pay ",(0,i.jsx)("b",{children:"R59.99 once off"})," via EFT to unlock all driver details."]})]}),(0,i.jsx)("div",{style:{border:"2px solid #2d9a4a",borderRadius:"16px",padding:"30px",background:"#fff",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"},children:p?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"10px 0"},children:[(0,i.jsx)("div",{style:{fontSize:"50px",marginBottom:"10px"},children:"\uD83D\uDCE8"}),(0,i.jsx)("h2",{style:{color:"#2d9a4a",marginBottom:"10px"},children:"Notification Received"}),(0,i.jsxs)("p",{style:{color:"#475569",fontSize:"14px",lineHeight:"1.6"},children:["Thank you! Your Proof of Payment has been uploaded. Your access will be activated once the ",(0,i.jsx)("b",{children:"R59.99"})," reflects in our account."]}),(0,i.jsx)("button",{onClick:()=>m.push("/"),style:{marginTop:"20px",background:"#f1f5f9",border:"1px solid #cbd5e1",padding:"10px 20px",borderRadius:"6px",cursor:"pointer"},children:"Back to Home"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{marginBottom:20},children:[(0,i.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"16px"},children:"Step 1: Banking Details"}),(0,i.jsxs)("div",{style:{background:"#f8fafc",padding:"15px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",lineHeight:"1.8"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"Bank:"})," Capitec Business Account"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"Acc Holder:"})," Runnit Pty Ltd"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"Acc Number:"})," 1054733732"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"Branch Code:"})," 450105"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("b",{children:"Reference:"})," ",(0,i.jsx)("span",{style:{color:"#c53030",fontWeight:"bold"},children:x})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:20},children:[(0,i.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"16px"},children:"Step 2: Upload Proof of Payment"}),(0,i.jsxs)("div",{style:{border:"2px dashed #cbd5e1",padding:"15px",borderRadius:"8px",textAlign:"center",background:b?"#f0fdf4":"#fff"},children:[(0,i.jsx)("input",{type:"file",accept:"image/*,.pdf",onChange:handlePopUpload,style:{fontSize:"14px"}}),g&&(0,i.jsx)("p",{style:{fontSize:"12px",color:"#2d9a4a"},children:"Uploading..."}),b&&(0,i.jsx)("p",{style:{fontSize:"12px",color:"#2d9a4a",marginTop:"5px"},children:"✅ File uploaded successfully"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:25},children:[(0,i.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"16px"},children:"Step 3: Notify Us"}),(0,i.jsxs)("p",{style:{fontSize:"13px",color:"#64748b",lineHeight:"1.4"},children:["Transfer ",(0,i.jsx)("b",{children:"R59.99"})," using the reference above, upload your POP, then click the button below."]})]}),(0,i.jsx)("button",{onClick:handleNotifyEFT,disabled:n||g,style:{width:"100%",background:b?"#2d9a4a":"#94a3b8",color:"#fff",padding:"16px",borderRadius:"8px",border:"none",fontSize:"18px",fontWeight:"bold",cursor:b?"pointer":"not-allowed"},children:n?"Sending...":"Submit Proof of Payment"})]})}),(0,i.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:(0,i.jsxs)("p",{style:{fontSize:"14px",color:"#64748b"},children:["Questions?"," ",(0,i.jsx)(d(),{href:"/contact",style:{color:"#2d9a4a",textDecoration:"none",fontWeight:"bold"},children:"Contact Support"})]})})]}):null}},9008:function(e,t,n){e.exports=n(9201)},1163:function(e,t,n){e.exports=n(9974)}},function(e){e.O(0,[774,664,888,179],function(){return e(e.s=4263)}),_N_E=e.O()}]);
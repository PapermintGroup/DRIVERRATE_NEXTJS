(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7052)}])},7052:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Home}});var i=n(5893),r=n(7294),o=n(1664),a=n.n(o);function Home(){let[e,t]=(0,r.useState)([]),[n,o]=(0,r.useState)(""),[l,s]=(0,r.useState)("latest"),[d,c]=(0,r.useState)(null),[p,x]=(0,r.useState)("");(0,r.useEffect)(()=>{async function loadUser(){try{let e=await fetch("/api/me",{cache:"no-store",credentials:"include"}),t=await e.json();c(t.ok?t.user:null)}catch(e){console.error("Failed to load user",e),c(null)}}(async function(){let e=await fetch("/api/drivers",{cache:"no-store"}),n=await e.json(),i=n.drivers||n;t(Array.isArray(i)?i:[])})(),loadUser()},[]),(0,r.useEffect)(()=>{if(d&&d.paymentRequested&&!d.isSubscribed){let updateTimer=()=>{let e=d.updatedAt?new Date(d.updatedAt).getTime():new Date().getTime(),t=new Date().getTime(),n=e+864e5-t;n>0?x("".concat(Math.floor(n%864e5/36e5),"h ").concat(Math.floor(n%36e5/6e4),"m ").concat(Math.floor(n%6e4/1e3),"s")):x("Awaiting Final Admin Check")};updateTimer();let e=setInterval(updateTimer,1e3);return()=>clearInterval(e)}},[d]);let handleLogout=async()=>{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),c(null),window.location.href="/"},getRating=e=>{if(!e.reviews||0===e.reviews.length)return 0;let t=e.reviews.reduce((e,t)=>e+(t.punctuality+t.cleanliness+t.trustworthiness+t.safety+t.communication+t.reliability)/6,0);return t/e.reviews.length},u=e.filter(e=>{var t,i,r,o,a;let l=n.toLowerCase();return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(l))||(null===(i=e.serviceAreas)||void 0===i?void 0:i.toLowerCase().includes(l))||(null===(r=e.service_areas)||void 0===r?void 0:r.toLowerCase().includes(l))||(null===(o=e.companyName)||void 0===o?void 0:o.toLowerCase().includes(l))||(null===(a=e.company_name)||void 0===a?void 0:a.toLowerCase().includes(l))}).sort((e,t)=>"highest"===l?getRating(t)-getRating(e):"lowest"===l?getRating(e)-getRating(t):new Date(t.createdAt)-new Date(e.createdAt));return(0,i.jsxs)("div",{style:{fontFamily:"Arial, sans-serif",background:"#f0fdf4",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[d&&(0,i.jsxs)("div",{style:{background:d.isSubscribed?"#dcfce7":d.paymentRequested?"#fef3c7":"#fee2e2",color:d.isSubscribed?"#166534":d.paymentRequested?"#92400e":"#991b1b",padding:"10px 16px",textAlign:"center",fontSize:"14px",fontWeight:"bold",borderBottom:"1px solid ".concat(d.isSubscribed?"#bbf7d0":d.paymentRequested?"#fde68a":"#fecaca")},children:[d.isSubscribed?"✅ Subscribed Account":d.paymentRequested?(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px"},children:[(0,i.jsx)("span",{children:"⏳ Payment Pending Approval"}),p&&(0,i.jsxs)("span",{style:{background:"#92400e",color:"#fff",padding:"2px 8px",borderRadius:"4px",fontSize:"12px"},children:["Est. Approval: ",p]})]}):"❌ Not Subscribed - Listing restricted",!d.isSubscribed&&!d.paymentRequested&&(0,i.jsx)(a(),{href:"/subscribe",style:{marginLeft:"12px",textDecoration:"underline",color:"#991b1b",background:"rgba(255,255,255,0.3)",padding:"2px 8px",borderRadius:"4px"},children:"Fix Now for R59.99"})]}),(0,i.jsxs)("header",{style:{background:"#2d9a4a",color:"#fff",padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,i.jsx)("h1",{style:{fontSize:"22px",fontWeight:"bold",margin:0,whiteSpace:"nowrap"},children:"DriverRate"}),(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"10px",flexWrap:"wrap",justifyContent:"flex-end"},children:d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{style:{fontSize:"14px",fontWeight:"600",whiteSpace:"nowrap"},children:["Hi, ",d.name]}),(0,i.jsx)("button",{onClick:handleLogout,style:{padding:"6px 12px",background:"#fff",color:"#dc2626",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px"},children:"Logout"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a(),{href:"/login",style:{padding:"6px 12px",background:"#fff",color:"#2d9a4a",borderRadius:"6px",textDecoration:"none",fontWeight:"bold",fontSize:"14px"},children:"Login"}),(0,i.jsx)(a(),{href:"/register",style:{padding:"6px 12px",background:"#fff",color:"#2d9a4a",borderRadius:"6px",textDecoration:"none",fontWeight:"bold",fontSize:"14px"},children:"Register"})]})})]}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("section",{style:{textAlign:"center",padding:"40px 20px"},children:(0,i.jsx)("p",{style:{fontSize:"18px",color:"#065f46",maxWidth:"600px",margin:"0 auto"},children:"Find trusted lift-club drivers rated for punctuality, safety, and reliability."})}),(0,i.jsxs)("div",{style:{maxWidth:"900px",margin:"0 auto 20px",padding:"0 20px",display:"flex",gap:"10px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Search name, area, or company...",value:n,onChange:e=>o(e.target.value),style:{flex:2,padding:"12px",borderRadius:"8px",border:"2px solid #2d9a4a",outline:"none"}}),(0,i.jsxs)("select",{value:l,onChange:e=>s(e.target.value),style:{flex:1,padding:"12px",borderRadius:"8px",border:"2px solid #2d9a4a",background:"#fff",cursor:"pointer"},children:[(0,i.jsx)("option",{value:"latest",children:"Newest First"}),(0,i.jsx)("option",{value:"highest",children:"Highest Rated"}),(0,i.jsx)("option",{value:"lowest",children:"Lowest Rated"})]})]}),(0,i.jsxs)("main",{style:{maxWidth:"900px",margin:"0 auto",padding:"0 20px 40px"},children:[(0,i.jsx)("h2",{style:{fontSize:"22px",marginBottom:"20px"},children:n?"Results (".concat(u.length,")"):"All Drivers"}),0===u.length?(0,i.jsx)("p",{children:"No drivers found."}):(0,i.jsx)("ul",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px",padding:0,listStyle:"none"},children:u.map(e=>{var t;let n=getRating(e),r=(null===(t=e.reviews)||void 0===t?void 0:t.length)||0;return(0,i.jsxs)("li",{style:{background:"#fff",padding:"20px",borderRadius:"10px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 10px",fontSize:"18px",fontWeight:"bold"},children:e.name}),(0,i.jsx)("p",{style:{margin:"0 0 5px",color:"#4b5563"},children:e.companyName||e.company_name||"Independent Driver"}),(0,i.jsxs)("p",{style:{margin:"0 0 10px",fontSize:"12px",color:"#6b7280"},children:["\uD83D\uDCCD ",e.serviceAreas||e.service_areas||"Global"]}),(0,i.jsxs)("p",{style:{margin:"0 0 10px",fontSize:"14px",fontWeight:"bold",color:"#f39c12"},children:["★ ",n>0?n.toFixed(1):"N/A",(0,i.jsxs)("span",{style:{color:"#6b7280",fontWeight:"normal",fontSize:"12px",marginLeft:"5px"},children:["(",r," ",1===r?"review":"reviews",")"]})]}),(0,i.jsx)(a(),{href:"/profile/".concat(e.id),style:{color:"#2d9a4a",fontWeight:"bold",textDecoration:"underline"},children:"View Profile"})]},e.id)})})]})]}),(0,i.jsxs)("footer",{style:{textAlign:"center",padding:"32px 24px",fontSize:"14px",color:"#065f46",background:"#fff",borderTop:"1px solid #dcfce7"},children:[(0,i.jsx)("div",{style:{marginBottom:"16px"},children:(0,i.jsx)("button",{onClick:()=>{window.location.href="/support"},style:{padding:"10px 18px",background:"#2d9a4a",color:"#fff",border:"none",borderRadius:"999px",fontWeight:"bold",fontSize:"14px",cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,0.15)"},children:"❤️Click to Support DriverRate❤️"})}),(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:["\xa9 ",new Date().getFullYear()," ",(0,i.jsx)("strong",{children:"DriverRate"}),". All rights reserved."]}),(0,i.jsxs)("div",{style:{color:"#6b7280"},children:["Powered by"," ",(0,i.jsx)("a",{href:"https://www.papermint.group",target:"_blank",rel:"noopener noreferrer",style:{color:"#2d9a4a",fontWeight:"bold",textDecoration:"none"},children:"Papermint Group"})]})]})]})}}},function(e){e.O(0,[774,664,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[192],{2494:function(e,i,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/[id]",function(){return r(1833)}])},4225:function(e,i,r){"use strict";r.d(i,{Z:function(){return NavBack}});var t=r(5893),n=r(1163);function NavBack(){let e=(0,n.useRouter)();return(0,t.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:(0,t.jsx)("button",{onClick:()=>e.back(),style:{background:"#e5e7eb",border:"none",padding:"8px 14px",borderRadius:6,cursor:"pointer",fontWeight:"bold"},children:"← Back"})})}r(1664)},1833:function(e,i,r){"use strict";r.r(i),r.d(i,{__N_SSP:function(){return c},default:function(){return Profile}});var t=r(5893),n=r(9008),s=r.n(n),o=r(7294),l=r(1664),a=r.n(l),d=r(4225),c=!0;function Profile(e){let{driver:i,reviews:r,scores:n}=e,[l,c]=(0,o.useState)(!1),[p,x]=(0,o.useState)(null),[u,h]=(0,o.useState)(!1);(0,o.useEffect)(()=>{c(!0),async function(){try{let e=await fetch("/api/me",{cache:"no-store"}),i=await e.json();x(i.ok?i.user:null)}catch(e){x(null)}}()},[]);let f=p&&r.some(e=>e.userId===p.id),m=(null==p?void 0:p.isSubscribed)===!0||(null==p?void 0:p.role)==="admin",SocialLink=e=>{let{href:i,icon:r,label:n}=e;return i&&m?(0,t.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",title:n,style:{fontSize:"20px",textDecoration:"none",filter:"grayscale(0.2)",transition:"transform 0.2s"},onMouseOver:e=>e.currentTarget.style.transform="scale(1.2)",onMouseOut:e=>e.currentTarget.style.transform="scale(1)",children:r}):null};return(0,t.jsxs)("div",{style:{maxWidth:900,margin:"24px auto",padding:16,fontFamily:"Arial, sans-serif"},children:[(0,t.jsx)(d.Z,{}),(0,t.jsxs)(s(),{children:[(0,t.jsxs)("title",{children:[i.name," — DriverRate"]}),(0,t.jsx)("meta",{property:"og:title",content:"Rate ".concat(i.name," on DriverRate")}),(0,t.jsx)("meta",{property:"og:description",content:"Current Rating: ★ ".concat(n.overall,"/5. Notify others about high-risk drivers or rate your experience.")}),(0,t.jsx)("meta",{property:"og:image",content:i.profilePhoto||"/placeholder.png"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:24,borderBottom:"2px solid #eee",paddingBottom:24,flexWrap:"wrap"},children:[(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("img",{src:i.profilePhoto||"/placeholder.png",style:{borderRadius:8,objectFit:"cover",background:"#f4f4f4",width:160,height:160},alt:i.name}),i.idPic&&(0,t.jsx)("div",{style:{position:"absolute",bottom:"-10px",left:"50%",transform:"translateX(-50%)",background:"#2d9a4a",color:"white",fontSize:"10px",padding:"4px 8px",borderRadius:"12px",fontWeight:"bold",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"✅ ID VERIFIED"})]}),(0,t.jsxs)("div",{style:{flex:1,minWidth:200},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,t.jsx)("h1",{style:{color:"#2d9a4a",margin:"0 0 8px 0"},children:i.name}),(0,t.jsxs)("div",{style:{display:"flex",gap:"12px",padding:"4px"},children:[(0,t.jsx)(SocialLink,{href:i.facebook,icon:"\uD83D\uDCD8",label:"Facebook"}),(0,t.jsx)(SocialLink,{href:i.instagram,icon:"\uD83D\uDCF8",label:"Instagram"}),(0,t.jsx)(SocialLink,{href:i.twitter||i.x,icon:"\uD83D\uDC26",label:"X (Twitter)"}),(0,t.jsx)(SocialLink,{href:i.whatsapp,icon:"\uD83D\uDCAC",label:"WhatsApp"})]})]}),(0,t.jsx)("div",{style:{fontWeight:"bold",color:"#555"},children:i.companyName||"Independent Driver"}),(0,t.jsxs)("div",{style:{marginTop:8},children:[(0,t.jsx)("strong",{children:"Areas:"})," ",i.serviceAreas||"Not specified"]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:12},children:[(0,t.jsx)("button",{onClick:()=>{let e=window.location.href;navigator.clipboard.writeText(e),h(!0),setTimeout(()=>h(!1),2e3)},style:{background:u?"#166534":"#eefaf0",color:u?"#fff":"#2d9a4a",border:"1px solid #2d9a4a",padding:"8px 14px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold",transition:"0.2s"},children:u?"✅ Link Copied!":"\uD83D\uDD17 Copy Share Link"}),(0,t.jsx)("button",{onClick:()=>{let e=encodeURIComponent("HIGH RISK REPORT: ".concat(i.name)),r=encodeURIComponent("Admin, I am reporting driver ".concat(i.name," (ID: ").concat(i.id,") as high risk.\n\nReason: "));window.location.href="mailto:admin@driverrate.co.za?subject=".concat(e,"&body=").concat(r)},style:{background:"#fef2f2",color:"#991b1b",border:"1px solid #fee2e2",padding:"8px 14px",borderRadius:"6px",cursor:"pointer",fontSize:"13px",fontWeight:"bold"},children:"\uD83D\uDEA9 Flag High Risk"})]}),(0,t.jsx)("div",{style:{marginTop:20},children:m?(0,t.jsxs)("div",{style:{padding:"16px",borderRadius:"12px",background:"#f0fdf4",border:"1px solid #2d9a4a",fontSize:"14px"},children:[(0,t.jsx)("div",{style:{color:"#166534",fontWeight:"bold",marginBottom:"10px"},children:"✅ Subscriber Access Unlocked"}),(0,t.jsxs)("div",{style:{marginBottom:"6px"},children:["\uD83D\uDCDE ",(0,t.jsx)("b",{children:"Phone:"})," ",i.phone||"Not provided"]}),(0,t.jsxs)("div",{style:{marginBottom:"6px"},children:["✉️ ",(0,t.jsx)("b",{children:"Email:"})," ",i.email||"Not provided"]}),(0,t.jsxs)("div",{children:["\uD83D\uDEE3️ ",(0,t.jsx)("b",{children:"Specific Routes:"})," ",i.routes||"Contact driver for details"]})]}):(0,t.jsxs)("div",{style:{padding:"24px",borderRadius:"12px",background:"#fef2f2",border:"2px solid #fee2e2",textAlign:"center"},children:[(0,t.jsx)("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"\uD83D\uDD12"}),(0,t.jsx)("h3",{style:{margin:"0 0 8px 0",color:"#991b1b"},children:"Driver Information Locked"}),(0,t.jsx)("p",{style:{fontSize:"14px",color:"#7f1d1d",marginBottom:"16px",lineHeight:"1.5"},children:"The phone number, email address, and vehicle photos are only available to active subscribers."}),(0,t.jsx)(a(),{href:"/subscribe",style:{display:"inline-block",background:"#2d9a4a",color:"#fff",padding:"12px 24px",borderRadius:"8px",textDecoration:"none",fontSize:"15px",fontWeight:"bold"},children:"Click here to subscribe for R59.99/pm"})]})}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 20px",marginTop:20,fontSize:"13px"},children:[(0,t.jsxs)("div",{children:["Punctuality: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.punctuality]})]}),(0,t.jsxs)("div",{children:["Safety: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.safety]})]}),(0,t.jsxs)("div",{children:["Cleanliness: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.cleanliness]})]}),(0,t.jsxs)("div",{children:["Comm: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.communication]})]}),(0,t.jsxs)("div",{children:["Trust: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.trustworthiness]})]}),(0,t.jsxs)("div",{children:["Reliability: ",(0,t.jsxs)("span",{style:{color:"#f39c12"},children:["★ ",n.reliability]})]})]}),(0,t.jsxs)("div",{style:{marginTop:12,fontSize:"1.2rem",fontWeight:"bold"},children:["Overall: ",(0,t.jsxs)("span",{style:{color:"#2d9a4a"},children:[n.overall," / 5"]})]})]})]}),m&&i.vehiclePics&&(0,t.jsxs)("section",{style:{marginTop:32},children:[(0,t.jsx)("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"8px",color:"#444"},children:"Vehicle Verification"}),(0,t.jsxs)("div",{style:{marginTop:"12px",background:"#f9f9f9",padding:"16px",borderRadius:"8px"},children:[(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:(()=>{try{let e=JSON.parse(i.vehiclePics);return Array.isArray(e)?e.map((e,i)=>(0,t.jsx)("img",{src:e,alt:"Vehicle View ".concat(i+1),style:{width:"100%",height:"200px",borderRadius:"6px",objectFit:"cover",display:"block",border:"1px solid #ddd"}},i)):null}catch(e){return(0,t.jsx)("img",{src:i.vehiclePics,alt:"Verified Vehicle",style:{width:"100%",borderRadius:8,maxHeight:"500px",objectFit:"contain"}})}})()}),(0,t.jsx)("p",{style:{fontSize:"12px",color:"#666",marginTop:"12px",textAlign:"center"},children:"Standard vehicle used for the routes listed above. Images verified for security."})]})]}),(0,t.jsxs)("section",{style:{marginTop:32},children:[(0,t.jsxs)("h2",{children:["Reviews (",r.length,")"]}),0===r.length?(0,t.jsx)("p",{style:{color:"#777"},children:"No reviews yet."}):r.map(e=>{var i,r;return(0,t.jsxs)("div",{style:{border:"1px solid #eee",padding:16,borderRadius:8,marginTop:12,background:"#fff"},children:[(0,t.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{fontWeight:"bold",color:"#333",fontSize:"15px"},children:[(null===(i=e.user)||void 0===i?void 0:i.name)||"Anonymous User",(0,t.jsx)("span",{style:{marginLeft:8,fontSize:"11px",color:"#2d9a4a",background:"#eefaf0",padding:"2px 6px",borderRadius:"4px",textTransform:"uppercase"},children:(null===(r=e.user)||void 0===r?void 0:r.role)||"user"})]}),(0,t.jsx)("div",{style:{fontSize:12,color:"#999"},children:l?new Date(e.createdAt).toLocaleDateString():""})]})}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px 15px",margin:"12px 0",fontSize:"12px",background:"#f9f9f9",padding:"10px",borderRadius:"6px",border:"1px solid #f0f0f0"},children:[(0,t.jsxs)("span",{children:["\uD83D\uDD52 Punc: ",(0,t.jsx)("b",{children:e.punctuality})]}),(0,t.jsxs)("span",{children:["✨ Clean: ",(0,t.jsx)("b",{children:e.cleanliness})]}),(0,t.jsxs)("span",{children:["\uD83E\uDD1D Trust: ",(0,t.jsx)("b",{children:e.trustworthiness})]}),(0,t.jsxs)("span",{children:["\uD83D\uDEE1️ Safety: ",(0,t.jsx)("b",{children:e.safety})]}),(0,t.jsxs)("span",{children:["\uD83D\uDCDE Comm: ",(0,t.jsx)("b",{children:e.communication})]}),(0,t.jsxs)("span",{children:["✅ Rel: ",(0,t.jsx)("b",{children:e.reliability})]})]}),(0,t.jsx)("div",{style:{marginTop:8,color:"#444",lineHeight:"1.5"},children:e.comment||(0,t.jsx)("span",{style:{color:"#999",fontStyle:"italic"},children:"No comment provided."})})]},e.id)})]}),(0,t.jsxs)("section",{style:{marginTop:32,padding:20,background:"#f9f9f9",borderRadius:8},children:[(0,t.jsx)("h2",{children:"Leave a review"}),(0,t.jsx)("p",{style:{fontSize:"13px",color:"#666",marginBottom:"15px"},children:"Help others by notifying them about high-risk drivers or praising great service."}),l?p?f?(0,t.jsx)("p",{style:{color:"#2d9a4a",fontWeight:"bold"},children:"✅ You have already rated this driver."}):(0,t.jsx)(ReviewForm,{id:i.id,userId:p.id}):(0,t.jsxs)("p",{children:["Please ",(0,t.jsx)(a(),{href:"/login",style:{color:"#2d9a4a",fontWeight:"bold"},children:"Login"})," to leave a review."]}):(0,t.jsx)("p",{children:"Loading..."})]})]})}function ReviewForm(e){let{id:i,userId:r}=e;async function submit(e){e.preventDefault();let t=new FormData(e.target),n=Object.fromEntries(t.entries()),s={driverId:i,userId:r,punctuality:Number(n.punctuality),cleanliness:Number(n.cleanliness),trustworthiness:Number(n.trustworthiness),safety:Number(n.safety),communication:Number(n.communication),reliability:Number(n.reliability),comment:n.comment},o=await fetch("/api/reviews/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});(await o.json()).ok?(alert("Thanks for your review"),window.location.reload()):alert("Error submitting review")}return(0,t.jsxs)("form",{onSubmit:submit,style:{display:"grid",gap:12},children:[(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:12},children:[(0,t.jsxs)("label",{style:p,children:["Punctuality",(0,t.jsx)("input",{type:"number",name:"punctuality",defaultValue:"5",min:"1",max:"5",style:x})]}),(0,t.jsxs)("label",{style:p,children:["Cleanliness",(0,t.jsx)("input",{type:"number",name:"cleanliness",defaultValue:"5",min:"1",max:"5",style:x})]}),(0,t.jsxs)("label",{style:p,children:["Trustworthiness",(0,t.jsx)("input",{type:"number",name:"trustworthiness",defaultValue:"5",min:"1",max:"5",style:x})]}),(0,t.jsxs)("label",{style:p,children:["Safety",(0,t.jsx)("input",{type:"number",name:"safety",defaultValue:"5",min:"1",max:"5",style:x})]}),(0,t.jsxs)("label",{style:p,children:["Communication",(0,t.jsx)("input",{type:"number",name:"communication",defaultValue:"5",min:"1",max:"5",style:x})]}),(0,t.jsxs)("label",{style:p,children:["Reliability",(0,t.jsx)("input",{type:"number",name:"reliability",defaultValue:"5",min:"1",max:"5",style:x})]})]}),(0,t.jsx)("textarea",{name:"comment",rows:"3",placeholder:"Explain your experience (good or bad)...",style:{...x,resize:"vertical"}}),(0,t.jsx)("button",{type:"submit",style:{background:"#2d9a4a",color:"#fff",padding:"12px",border:"none",borderRadius:6,cursor:"pointer",fontWeight:"bold"},children:"Submit review"})]})}let p={fontSize:"12px",fontWeight:"bold",color:"#666"},x={padding:"8px",borderRadius:"4px",border:"1px solid #ccc",width:"100%",boxSizing:"border-box"}},9008:function(e,i,r){e.exports=r(9201)},1163:function(e,i,r){e.exports=r(9974)}},function(e){e.O(0,[774,664,888,179],function(){return e(e.s=2494)}),_N_E=e.O()}]);